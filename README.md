# –ê–ª–∫–æ—Ç–µ–∫–∞ –ü–∞—Ä—Å–µ—Ä (Alkoteka Parser)

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Scrapy –ø–∞—Ä—Å–µ—Ä –¥–ª—è —Å–∞–π—Ç–∞ https://alkoteka.com —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö)
- [–û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤](#–æ—Ç–ª–∞–¥–∫–∞-—Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

---

## üéØ –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–∞—Ö —Å —Å–∞–π—Ç–∞ –ê–ª–∫–æ—Ç–µ–∫–∞:

- ‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤** - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ä–µ–π—Ç–∏–Ω–≥
- ‚úÖ **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤** - –æ–±—ä–µ–º, —Ü–≤–µ—Ç, –∏–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞
- ‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–º** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–µ–≥–∏–æ–Ω–∞ (cookies, headers)
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - retry –º–µ—Ö–∞–Ω–∏–∑–º, errback handlers –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - 187 unit —Ç–µ—Å—Ç–æ–≤ (–≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç)
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤** - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ spider

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –û—Å–Ω–æ–≤–Ω–æ–π Spider (950+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
- –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ —Ç–æ–≤–∞—Ä–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ 3 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
  - –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–±—ä–µ–º–∞ (500–º–ª, 1–ª –∏ —Ç.–¥.)
  - –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è —Ü–≤–µ—Ç–∞
  - JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ HTML (data-–∞—Ç—Ä–∏–±—É—Ç—ã)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (—Ä–∞–∑–º–µ—Ä—ã –æ–¥–µ–∂–¥—ã, –º–∞—Ç–µ—Ä–∏–∞–ª—ã)
- –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ (—Ü–µ–Ω–∞, —Ä–µ–π—Ç–∏–Ω–≥, —Å–∫–∏–¥–∫–∞, –Ω–∞–ª–∏—á–∏–µ, —Ç–µ–≥–∏)

### Three-Stage Pipeline (255 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
1. **ValidationPipeline** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 300)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π –≤ —Ü–µ–Ω–µ
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ

2. **DefaultValuesPipeline** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 400)
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–≤–∞–ª—é—Ç–∞, —Ä–µ–≥–∏–æ–Ω, –∏—Å—Ç–æ—á–Ω–∏–∫)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏ scraped_at
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä

3. **DataCleaningPipeline** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 500)
   - –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–±–µ–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ç–µ–≥–æ–≤ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### Middleware (400+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞)
- **RegionMiddleware** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–º —á–µ—Ä–µ–∑ cookies –∏ headers
- **ProxyMiddleware** - —Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º blacklist

### –£—Ç–∏–ª–∏—Ç—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã
- **validate_output.py** - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ JSON —Ñ–∞–π–ª–∞
- **test_selectors.py** - –æ—Ç–ª–∞–¥–∫–∞ CSS/XPath —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö URL

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- pip (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python)
- Git (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
cd /Users/expansion/PycharmProjects/Poduct-parser
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python3 -m venv venv
source venv/bin/activate  # –ù–∞ macOS/Linux
# –∏–ª–∏
venv\Scripts\activate     # –ù–∞ Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
scrapy version
python -c "import scrapy; print('Scrapy —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω')"
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ venv/                              # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
‚îú‚îÄ‚îÄ requirements.txt                   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ (pinned –≤–µ—Ä—Å–∏–∏)
‚îú‚îÄ‚îÄ README.md                          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ .gitignore                         # Git ignore –ø—Ä–∞–≤–∏–ª–∞
‚îÇ
‚îú‚îÄ‚îÄ validate_output.py                 # –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ JSON —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îú‚îÄ‚îÄ test_selectors.py                  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ alkoteka_parser/                   # –ì–ª–∞–≤–Ω–∞—è –ø–∞–ø–∫–∞ Scrapy –ø—Ä–æ–µ–∫—Ç–∞
    ‚îú‚îÄ‚îÄ scrapy.cfg                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Scrapy
    ‚îÇ
    ‚îú‚îÄ‚îÄ alkoteka_parser/               # –ü–∞–∫–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
    ‚îÇ   ‚îú‚îÄ‚îÄ settings.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Scrapy (113 —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îú‚îÄ‚îÄ items.py                   # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Item (353 —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îú‚îÄ‚îÄ item_loaders.py            # ItemLoader –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã (365 —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îú‚îÄ‚îÄ middlewares.py             # Region + Proxy middleware (400+ —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îú‚îÄ‚îÄ pipelines.py               # –í–∞–ª–∏–¥–∞—Ü–∏—è + –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (255 —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îú‚îÄ‚îÄ utils.py                   # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–æ–∫—Å–∏ (140 —Å—Ç—Ä–æ–∫)
    ‚îÇ   ‚îÇ
    ‚îÇ   ‚îî‚îÄ‚îÄ spiders/
    ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
    ‚îÇ       ‚îî‚îÄ‚îÄ alkoteka_spider.py     # –û—Å–Ω–æ–≤–Ω–æ–π spider (950+ —Å—Ç—Ä–æ–∫)
    ‚îÇ
    ‚îî‚îÄ‚îÄ tests/
        ‚îú‚îÄ‚îÄ __init__.py
        ‚îú‚îÄ‚îÄ test_items.py              # 59 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è items (236 —Å—Ç—Ä–æ–∫)
        ‚îú‚îÄ‚îÄ test_middlewares.py        # 13 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è middlewares (146 —Å—Ç—Ä–æ–∫)
        ‚îú‚îÄ‚îÄ test_proxy_middleware.py   # 11 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è proxy (220 —Å—Ç—Ä–æ–∫)
        ‚îú‚îÄ‚îÄ test_spider.py             # 75 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è spider (850+ —Å—Ç—Ä–æ–∫)
        ‚îî‚îÄ‚îÄ test_pipelines.py          # 29 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è pipelines (450+ —Å—Ç—Ä–æ–∫)
```

---

## üîç –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
source venv/bin/activate  # macOS/Linux
# –∏–ª–∏
venv\Scripts\activate     # Windows
```

### –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ spider

```bash
cd alkoteka_parser
scrapy crawl alkoteka -O result.json
```

–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `result.json` –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥

```bash
# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö spider
scrapy list

# –ó–∞–ø—É—Å–∫ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ä–µ–≥–∏–æ–Ω–æ–º
scrapy crawl alkoteka -O products.json

# –ó–∞–ø—É—Å–∫ —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω—ã–º –ø—Ä–æ–∫—Å–∏
# (–æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ settings.py: PROXY_ENABLED = False)

# –ó–∞–ø—É—Å–∫ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º —É—Ä–æ–≤–Ω—è DEBUG
scrapy crawl alkoteka -O products.json -L DEBUG

# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ spider)
scrapy crawl alkoteka -O vodka.json
```

### üì¶ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤. –§–æ—Ä–º–∞—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ spider.

#### JSON (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)

–ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

```bash
scrapy crawl alkoteka -O result.json
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```json
[
  {
    "product_id": "12345",
    "name": "–í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª",
    "price": 599.99,
    "original_price": 699.99,
    "category": "vodka",
    "image_urls": ["https://img1.jpg", "https://img2.jpg"],
    "price_data": {
      "current": 599.99,
      "original": 699.99,
      "currency": "RUB"
    },
    "stock_data": {
      "in_stock": true,
      "count": 15,
      "status": "–í –Ω–∞–ª–∏—á–∏–∏"
    },
    "rating": 4.5,
    "review_count": 42
  }
]
```

#### JSON Lines (JSONL) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

–ö–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è JSON —Å—Ç—Ä–æ–∫–∞. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

```bash
scrapy crawl alkoteka -O result.jsonl
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```jsonl
{"product_id": "12345", "name": "–í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º", "price": 599.99, "category": "vodka", ...}
{"product_id": "12346", "name": "–ö–æ–Ω—å—è–∫", "price": 899.99, "category": "cognac", ...}
{"product_id": "12347", "name": "–ü–∏–≤–æ", "price": 79.99, "category": "beer", ...}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ JSONL:**
- ‚úÖ –ú–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ (–ø–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (jq, pandas, Apache Spark)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å bash —É—Ç–∏–ª–∏—Ç–∞–º–∏ (grep, sed, awk)

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è JSONL:**
```bash
# –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
wc -l result.jsonl

# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã —Ç–æ–ª—å–∫–æ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 'vodka'
jq 'select(.category=="vodka")' result.jsonl

# –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤
jq '.name' result.jsonl

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Python
python3 -c "
import json
with open('result.jsonl') as f:
    products = [json.loads(line) for line in f]
    for p in products[:5]:
        print(f\"{p['name']}: {p['price']} RUB\")
"
```

#### CSV - —Ç–∞–±–ª–∏—Ü—ã –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

–¢–∞–±—É–ª—è—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Excel, Google Sheets –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ JSON.

```bash
scrapy crawl alkoteka -O result.csv
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```csv
product_id,name,price,original_price,category,rating,review_count,in_stock,image_urls
12345,–í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª,599.99,699.99,vodka,4.5,42,true,"['https://img1.jpg', 'https://img2.jpg']"
12346,–ö–æ–Ω—å—è–∫,899.99,999.99,cognac,4.7,28,true,"['https://img3.jpg']"
12347,–ü–∏–≤–æ,79.99,89.99,beer,4.2,156,true,"['https://img4.jpg', 'https://img5.jpg']"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CSV:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å –≤ Excel (macOS)
open result.csv

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ HTML —Ç–∞–±–ª–∏—Ü—É
python3 -c "
import csv
import json

with open('result.csv') as f:
    reader = csv.DictReader(f)
    print('<table>')
    for row in reader:
        print('<tr>')
        for key, val in row.items():
            print(f'<td>{val}</td>')
        print('</tr>')
    print('</table>')
" > result.html

# –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ —Ü–µ–Ω–µ (>500 RUB)
python3 -c "
import csv
with open('result.csv') as f:
    reader = csv.DictReader(f)
    for row in reader:
        if float(row['price']) > 500:
            print(f\"{row['name']}: {row['price']} RUB\")
"
```

#### XML - –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç XML —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

```bash
scrapy crawl alkoteka -O result.xml
```

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
```xml
<?xml version="1.0" encoding="UTF-8"?>
<products version="1.0" encoding="UTF-8">
  <product>
    <product_id>12345</product_id>
    <name>–í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª</name>
    <price>599.99</price>
    <original_price>699.99</original_price>
    <category>vodka</category>
    <rating>4.5</rating>
    <review_count>42</review_count>
    <in_stock>true</in_stock>
    <image_urls>
      <item>https://img1.jpg</item>
      <item>https://img2.jpg</item>
    </image_urls>
    <price_data>
      <current>599.99</current>
      <original>699.99</original>
      <currency>RUB</currency>
    </price_data>
    <stock_data>
      <in_stock>true</in_stock>
      <count>15</count>
      <status>–í –Ω–∞–ª–∏—á–∏–∏</status>
    </stock_data>
  </product>
  <product>
    ...
  </product>
</products>
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ XML:**
```bash
# –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å XML
xmllint --format result.xml > result_formatted.xml

# –ò–∑–≤–ª–µ—á—å –≤—Å–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ XPath
xmllint --xpath "//product/name/text()" result.xml

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ JSON
python3 -c "
import xml.etree.ElementTree as ET
import json

tree = ET.parse('result.xml')
root = tree.getroot()

products = []
for product in root.findall('product'):
    p = {child.tag: child.text for child in product}
    products.append(p)

print(json.dumps(products, indent=2, ensure_ascii=False))
" > result_from_xml.json
```

#### –í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞

| –§–æ—Ä–º–∞—Ç | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ | –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ | –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ |
|--------|-----------|------------|-----------|
| **JSON** | –í–µ–±-API, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ | –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ | –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä, –º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ |
| **JSONL** | –ë–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ, –ø–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ | –ú–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä, –±—ã—Å—Ç—Ä–æ | –¢—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| **CSV** | Excel, —Ç–∞–±–ª–∏—Ü—ã, BI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | –°–æ–≤–º–µ—Å—Ç–∏–º–æ, –ø—Ä–æ—Å—Ç–æ | –ù–µ–ª—å–∑—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã |
| **XML** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, –≤–∞–ª–∏–¥–∞—Ü–∏—è | –ë–æ–ª—å—à–æ–π, –º–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ |

#### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏

```bash
# JSON ‚Üí CSV
python3 -c "
import json, csv

with open('result.json') as f:
    products = json.load(f)

with open('result.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.DictWriter(f, fieldnames=['product_id', 'name', 'price'])
    writer.writeheader()
    for p in products:
        writer.writerow({k: p.get(k) for k in ['product_id', 'name', 'price']})
"

# JSONL ‚Üí JSON
jq -s '.' result.jsonl > result.json

# CSV ‚Üí JSON
python3 -c "
import csv, json

products = []
with open('result.csv') as f:
    for row in csv.DictReader(f):
        products.append(row)

with open('result.json', 'w') as f:
    json.dump(products, f, indent=2, ensure_ascii=False)
"
```

### üêö –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞ (Scrapy Shell)

**Scrapy Shell** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è Python –æ–±–æ–ª–æ—á–∫–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∏ –ª–æ–≥–∏–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

#### –û—Å–Ω–æ–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
cd alkoteka_parser

# –ó–∞–ø—É—Å–∫ shell –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
scrapy shell "https://alkoteka.com/catalog/category/vodka/"

# –ó–∞–ø—É—Å–∫ shell –¥–ª—è —Ç–æ–≤–∞—Ä–∞
scrapy shell "https://alkoteka.com/product/12345/"
```

#### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –≤ shell

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∞
>>> response.css('h1.product-title::text').get()
'–í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª'

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã
>>> response.css('.price-current::text').get()
'599.99'

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
>>> response.css('a.product-link::attr(href)').getall()
['/product/123/', '/product/124/', '/product/125/', ...]

# –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
>>> response.css('img.product-gallery::attr(src)').getall()
['https://...img1.jpg', 'https://...img2.jpg', ...]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
>>> response.css('.in-stock').get() is not None
True

# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ç–æ–≤–∞—Ä–∞
>>> response.css('table.characteristics tr td::text').getall()
['–û–±—ä–µ–º', '500 –º–ª', '–ö—Ä–µ–ø–æ—Å—Ç—å', '40%', '–°—Ç—Ä–∞–Ω–∞', '–†–æ—Å—Å–∏—è']

# –†–∞–±–æ—Ç–∞ —Å JSON –≤ data-–∞—Ç—Ä–∏–±—É—Ç–∞—Ö
>>> import json
>>> variants_json = response.css('[data-variants]::attr(data-variants)').get()
>>> json.loads(variants_json) if variants_json else None
{'volumes': ['500ml', '750ml', '1L'], ...}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–≤–µ—Ç–∞
>>> response.status
200

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –æ—Ç–≤–µ—Ç–∞
>>> response.headers['Content-Type']
b'text/html; charset=utf-8'
```

#### –ü–æ–ª–µ–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤ shell

```python
# –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –Ω–æ–≤—ã–º URL
>>> fetch("https://new-url.com")

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ö–æ–¥–Ω–æ–≥–æ HTML
>>> print(response.text[:500])

# –ü—Ä–æ–≤–µ—Ä–∫–∞ XPath
>>> response.xpath('//h1/text()').get()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CSS —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
>>> response.css('h1::text').getall()

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
>>> [p.css('::text').get() for p in response.css('.product-item')]

# –≠–∫—Å–ø–æ—Ä—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ JSON
>>> import json
>>> data = {
...     'title': response.css('h1::text').get(),
...     'price': response.css('.price::text').get(),
...     'images': response.css('img::attr(src)').getall()
... }
>>> print(json.dumps(data, indent=2, ensure_ascii=False))
```

#### –û—Ç–ª–∞–¥–∫–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ç–æ–≤–∞—Ä–∞

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
>>> for row in response.css('table.characteristics tr'):
...     key = row.css('td:first-child::text').get()
...     val = row.css('td:last-child::text').get()
...     print(f"{key}: {val}")

# –ü–æ–∏—Å–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
>>> response.xpath("//label[contains(text(), '–û–±—ä–µ–º')]/../text()").get()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
>>> title = response.css('h1::text').get()
>>> if title:
...     print(f"–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–π–¥–µ–Ω: {title.strip()}")
... else:
...     print("–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω")
```

#### –û—Ç–ª–∞–¥–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

```python
# –ü–æ–∏—Å–∫ –∫–Ω–æ–ø–∫–∏ "–î–∞–ª–µ–µ"
>>> next_page = response.css('a.next-page::attr(href)').get()
>>> next_page
'/catalog/category/vodka/?page=2'

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ URL –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π
>>> response.urljoin(next_page)
'https://alkoteka.com/catalog/category/vodka/?page=2'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
>>> bool(response.css('a.next-page').get())
True
```

#### –í—ã—Ö–æ–¥ –∏–∑ shell

```python
>>> exit()
# –∏–ª–∏
>>> quit()
```

#### –¢–∏–ø–∏—á–Ω—ã–π workflow –æ—Ç–ª–∞–¥–∫–∏

1. –ó–∞–ø—É—Å–∫ shell –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
2. –ò—Å–ø—ã—Ç–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
3. –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ spider —Å –Ω–æ–≤—ã–º —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–º
5. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ shell
6. –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ spider –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```bash
python validate_output.py result.json --verbose
```

–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
```
======================================================================
VALIDATION REPORT
======================================================================

üìä STATISTICS
  Total Products:    1234
  Valid Products:    1200
  Invalid Products:  34
  Total Errors:      5
  Total Warnings:    12

‚ùå ERRORS (5)
  ‚Ä¢ Product 10: Missing required field 'product_id'
  ‚Ä¢ Product 25: Missing required field 'name'
  ...

‚ö†Ô∏è  WARNINGS (12)
  ‚Ä¢ Product 5: Field 'price' has type str, expected (<class 'float'>, <class 'int'>)
  ‚Ä¢ Product 42: Field 'rating' is negative: -1
  ...
```

### –û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Ä–∞–±–æ—Ç–∞—é—Ç –ª–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–∞ —Ü–µ–ª–µ–≤–æ–º —Å–∞–π—Ç–µ:

```bash
python test_selectors.py https://alkoteka.com/catalog/category/vodka/ --category --export results.json
```

–ö–æ–º–∞–Ω–¥—ã:
```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Ç–æ–≤–∞—Ä–∞
python test_selectors.py https://url-to-product.com --product

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
python test_selectors.py https://url-to-category.com --category

# –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON
python test_selectors.py https://url.com --product -e debug_results.json

# –° —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º timeout (–¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–∞–π—Ç–æ–≤)
python test_selectors.py https://url.com --timeout 30
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (settings.py)

```python
TARGET_DOMAIN = "alkoteka.com"
DEFAULT_REGION = "Krasnodar"  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–µ–≥–∏–æ–Ω
REGION_NAME = "krasnodar"     # –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```

### Proxy –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–æ–∫—Å–∏, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `proxies.txt`:

```
http://proxy1:8080
http://proxy2:8080
socks5://proxy3:1080
```

–í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∫—Å–∏ (settings.py):
```python
PROXY_ENABLED = False  # True - –≤–∫–ª—é—á–∏—Ç—å, False - –≤—ã–∫–ª—é—á–∏—Ç—å
PROXY_FILE = "proxies.txt"
```

### –°–µ—Ç–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
CONCURRENT_REQUESTS = 8                    # –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
CONCURRENT_REQUESTS_PER_DOMAIN = 2         # –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ–º–µ–Ω
DOWNLOAD_DELAY = 1.5                       # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (—Å–µ–∫)
RANDOMIZE_DOWNLOAD_DELAY = True            # –†–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É
DOWNLOAD_TIMEOUT = 30                      # Timeout –∑–∞–ø—Ä–æ—Å–∞ (—Å–µ–∫)

RETRY_TIMES = 3                            # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤
RETRY_HTTP_CODES = [500, 502, 503, 504, 408, 429]
REDIRECT_ENABLED = True
REDIRECT_MAX_TIMES = 2
```

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (ValidationPipeline)

–ö–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
- `product_id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `name` - –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- `product_url` - URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç–æ–≤–∞—Ä–∞
- `scraped_at` - timestamp –ø–∞—Ä—Å–∏–Ω–≥–∞

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (DataCleaningPipeline)

| –ü–æ–ª–µ | –¢–∏–ø | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|------|-----|-----------|
| price | float/int | –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ |
| original_price | float/int | –ò—Å—Ö–æ–¥–Ω–∞—è —Ü–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| rating | float | –û—Ü–µ–Ω–∫–∞ 0-5 |
| review_count | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ |
| stock_quantity | int | –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å |
| discount_percentage | int | –°–∫–∏–¥–∫–∞ 0-100% |
| marketing_tags | list | –¢–µ–≥–∏ —Ç–æ–≤–∞—Ä–∞ |
| image_urls | list | URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |

### –ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

```json
{
  "product_id": "12345",
  "name": "–í–æ–¥–∫–∞ '–ü—Ä–µ–º–∏—É–º' 0.5–ª",
  "product_url": "https://alkoteka.com/product/12345/",
  "price": 599.99,
  "original_price": 699.99,
  "currency": "RUB",
  "rating": 4.5,
  "review_count": 42,
  "stock_quantity": 15,
  "discount_percentage": 14,
  "image_urls": [
    "https://image1.jpg",
    "https://image2.jpg"
  ],
  "marketing_tags": ["–ø–æ–ø—É–ª—è—Ä–Ω–æ–µ", "—Å–∫–∏–¥–∫–∞"],
  "variants": [
    {
      "type": "volume",
      "value": "0.5–ª",
      "price": 599.99,
      "available": true
    }
  ],
  "scraped_at": 1701604800,
  "source": "alkoteka.com",
  "region": "krasnodar"
}
```

---

## üîß –û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ test_selectors.py

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞—é—Ç –ª–∏ CSS/XPath —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:

```bash
python test_selectors.py https://alkoteka.com/product/12345/ --product --export debug.json
```

–ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä—ã:
- **–¢–æ–≤–∞—Ä**: –Ω–∞–∑–≤–∞–Ω–∏–µ, –±—Ä–µ–Ω–¥, —Ü–µ–Ω–∞, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–∞–ª–∏—á–∏–µ, –æ–ø–∏—Å–∞–Ω–∏–µ
- **–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ª–∞–¥–∫–∏

```
======================================================================
TESTING PRODUCT PAGE SELECTORS
======================================================================

üìç Basic Title Selectors:
‚úÖ Title (h1.product-title): –í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª
‚ùå Title (h1): None
‚úÖ Title (.product-name): –í–æ–¥–∫–∞ –ü—Ä–µ–º–∏—É–º 0.5–ª

üìç Price Selectors:
‚úÖ Price (.price): 599.99
‚ùå Price (span.product-price): None
‚úÖ Price ([data-price]): 599.99

...

======================================================================
SUMMARY
======================================================================

‚úÖ Found: 15/20
‚ùå Not found: 5/20

Not found selectors:
  ‚Ä¢ Title (h1): h1::text
  ‚Ä¢ Price (span.product-price): span.product-price::text
  ...
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ü–∞—Ä—Å–∏–Ω–≥ (Spider)

Spider `Alkoteka` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –∑–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏–∑ categories.json
2. **–ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
3. **–ü–∞—Ä—Å–∏–Ω–≥ —Ç–æ–≤–∞—Ä–æ–≤** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –æ —Ç–æ–≤–∞—Ä–µ
4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤** - –ø–æ–∏—Å–∫ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑:
   - –°–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–±—ä–µ–º–∞/—Ü–≤–µ—Ç–∞
   - –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –≤ HTML
   - JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤ data-–∞—Ç—Ä–∏–±—É—Ç–∞—Ö
5. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É

### –û–±—Ä–∞–±–æ—Ç–∫–∞ (Pipelines)

–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —Ç—Ä–∏ —ç—Ç–∞–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```
Spider Output
    ‚Üì
[ValidationPipeline] (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 300)
    ‚Üì (–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫)
[DefaultValuesPipeline] (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 400)
    ‚Üì (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
[DataCleaningPipeline] (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 500)
    ‚Üì (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞)
Clean JSON Output
```

### Middleware

#### RegionMiddleware
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç cookies –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞
- –î–æ–±–∞–≤–ª—è–µ—Ç headers —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ–≥–∏–æ–Ω–µ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 83 —Ä–µ–≥–∏–æ–Ω–∞ –†–§

#### ProxyMiddleware
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–∫—Å–∏ –∏–∑ —Ñ–∞–π–ª–∞
- –†–æ—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–∫—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø—Ä–æ–∫—Å–∏ –≤ blacklist
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø—Ä–æ–∫—Å–∏

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–ü—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ spider. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É `logs/stats/`.

#### –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è

- **–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
  - –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞
  - –û–±—â–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –∏ –º–∏–Ω—É—Ç–∞—Ö
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –º–∏–Ω—É—Ç—É

- **–°–µ—Ç–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  - –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫/–∏—Å–∫–ª—é—á–µ–Ω–∏–π

- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
  - –¢–æ–≤–∞—Ä–æ–≤ –≤ –º–∏–Ω—É—Ç—É (items/min)
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É (requests/min)
  - –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è spider

#### –ü—Ä–∏–º–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```json
{
  "spider_name": "alkoteka",
  "start_time": "2024-12-03T15:30:00",
  "end_time": "2024-12-03T15:45:30",
  "duration_seconds": 930,
  "duration_minutes": 15.5,
  "items_scraped": 245,
  "items_per_minute": 15.8,
  "request_count": 1200,
  "response_count": 1185,
  "response_received_count": 1185,
  "exception_count": 15,
  "error_count": 0,
  "start_reason": "finished"
}
```

#### –§–∞–π–ª—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –¥–≤—É—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö –≤ –ø–∞–ø–∫–µ `logs/stats/`:

```bash
logs/stats/
‚îú‚îÄ‚îÄ alkoteka_20241203_153000.json
‚îú‚îÄ‚îÄ alkoteka_20241203_153000.csv
‚îú‚îÄ‚îÄ alkoteka_20241203_160000.json
‚îî‚îÄ‚îÄ alkoteka_20241203_160000.csv
```

### Telegram –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤ Telegram —á–∞—Ç.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram:**
   - –ù–∞–ø–∏—à–∏—Ç–µ @BotFather: `/newbot`
   - –ù–∞–∑–æ–≤–∏—Ç–µ –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Alkoteka Parser Bot`)
   - –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤–∏–¥–∞: `123456789:ABCDEfghIJKLmnoPQRstuvWXYZ1234567890`

2. **–ü–æ–ª—É—á–∏—Ç–µ ID —á–∞—Ç–∞:**
   - –ù–∞–ø–∏—à–∏—Ç–µ @userinfobot –≤ Telegram
   - –û–Ω –≤–µ—Ä–Ω—ë—Ç –≤–∞—à user ID (—á–∞—Ç ID)
   - –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞ –±–æ—Ç–∞

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env (–∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
echo "TELEGRAM_BOT_TOKEN=your_token_here" > .env
echo "TELEGRAM_CHAT_ID=your_chat_id_here" >> .env
```

–ò–ª–∏ –≤ `settings.py`:
```python
TELEGRAM_ENABLED = True
TELEGRAM_BOT_TOKEN = "your_token_here"
TELEGRAM_CHAT_ID = "your_chat_id_here"
```

#### –ó–∞–ø—É—Å–∫ —Å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

```bash
cd alkoteka_parser

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
export TELEGRAM_BOT_TOKEN="your_token"
export TELEGRAM_CHAT_ID="your_chat_id"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ spider
scrapy crawl alkoteka -O result.json
```

#### –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ö–æ–≥–¥–∞ spider –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram:

```
üéâ Scraping Job Completed

üìä Statistics:
‚Ä¢ Spider: `alkoteka`
‚Ä¢ Duration: 930s (15.5 min)
‚Ä¢ Items Scraped: 245
‚Ä¢ Requests: 1200
‚Ä¢ Responses: 1185 (98.7%)
‚Ä¢ Errors: 15
‚Ä¢ Status: finished

‚è±Ô∏è Performance:
‚Ä¢ Items/min: 15.8
‚Ä¢ Requests/min: 77.4

‚úÖ All data exported successfully!
```

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram:

```python
from alkoteka_parser.extensions import TelegramNotifier

TelegramNotifier.send_alert(
    bot_token='your_token',
    chat_id='your_chat_id',
    message='‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Å–∞–π—Ç–∞ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å!'
)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

#### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# DEBUG - –º–∞–∫—Å–∏–º—É–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
scrapy crawl alkoteka -O result.json -L DEBUG

# INFO - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
scrapy crawl alkoteka -O result.json -L INFO

# WARNING - —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏
scrapy crawl alkoteka -O result.json -L WARNING

# ERROR - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
scrapy crawl alkoteka -O result.json -L ERROR
```

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
tail -50 logs/scrapy.log

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep ERROR logs/scrapy.log

# –ü–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
grep "product_id" logs/scrapy.log

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–æ–¥–∞–º –æ—à–∏–±–æ–∫
grep "HTTP" logs/scrapy.log | sort | uniq -c
```

#### –ò–º–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ –≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å –ø—É—Å—Ç—ã–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
jq 'select(.name | length == 0)' result.jsonl | wc -l

# –ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä—ã —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º–∏—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
jq '.image_urls | length' result.jsonl | sort | uniq -c

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
jq '.category' result.jsonl | sort | uniq -c
```

---

## üóÑÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

### SQLite Database Export

–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä—è–º–æ –≤ SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ JSON —Ñ–∞–π–ª–æ–≤.

#### –í–∫–ª—é—á–µ–Ω–∏–µ SQLite pipeline

–í `settings.py`:
```python
ITEM_PIPELINES = {
    'alkoteka_parser.pipelines.ValidationPipeline': 300,
    'alkoteka_parser.pipelines.DefaultValuesPipeline': 400,
    'alkoteka_parser.pipelines.DataCleaningPipeline': 500,
    'alkoteka_parser.database.SqlitePipeline': 600,  # –î–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ—Ç pipeline
}

# SQLite settings
DATABASE_NAME = 'products.db'
DATABASE_BATCH_SIZE = 100
```

#### –ó–∞–ø—É—Å–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î

```bash
cd alkoteka_parser

# –ü–∞—Ä—Å–∏–Ω–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ SQLite
scrapy crawl alkoteka

# –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ products.db
sqlite3 products.db ".tables"
```

#### –†–∞–±–æ—Ç–∞ —Å –ë–î —á–µ—Ä–µ–∑ Python

```python
from alkoteka_parser.database import DatabaseManager

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
manager = DatabaseManager('products.db')
manager.connect()

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å—ë —Ç–æ–≤–∞—Ä—ã
items = manager.query('SELECT * FROM products')
print(f"–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: {len(items)}")

# –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ü–µ–Ω–µ
expensive = manager.query(
    'SELECT name, price FROM products WHERE price > ? ORDER BY price DESC',
    (500,)
)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = manager.get_statistics()
print(f"Items: {stats['items_count']}")

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV
manager.export_to_csv('products.csv')

manager.disconnect()
```

#### SQL –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏–º–µ—Ä—ã

```bash
sqlite3 products.db

# –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤
SELECT COUNT(*) as total FROM products;

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
SELECT category, COUNT(*) as count FROM products GROUP BY category;

# –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
SELECT category, AVG(price) as avg_price FROM products GROUP BY category;

# –¢–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
SELECT id, name FROM products WHERE image_urls IS NULL OR image_urls = '';

# Top 10 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö
SELECT name, price FROM products ORDER BY price DESC LIMIT 10;

# –¢–æ–≤–∞—Ä—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–∏ 7 –¥–Ω–µ–π
SELECT * FROM products WHERE created_at > datetime('now', '-7 days');
```

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SQLite

- ‚úÖ –í—Å—Ç—Ä–æ—ë–Ω–Ω–∞—è –≤ Python (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫–µ (–Ω–µ –≤ –ø–∞–º—è—Ç–∏)
- ‚úÖ SQL –∑–∞–ø—Ä–æ—Å—ã (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –∞–≥—Ä–µ–≥–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
- ‚úÖ –õ–µ–≥–∫–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV/JSON

---

## üõ†Ô∏è –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ö–æ–º–∞–Ω–¥—ã

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (validate)

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
cd alkoteka_parser

# –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
scrapy validate -f ../result.json

# –° –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á—ë—Ç–æ–º
scrapy validate -f ../result.json -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ CSV
scrapy validate -f ../result.csv --format csv

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π
scrapy validate -f ../result.json --check-fields product_id,name,price

# –°–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
scrapy validate -f ../result.json --stats
```

#### –û—Ç—á—ë—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏

```
======================================================================
DATA VALIDATION REPORT
======================================================================

üìä SUMMARY
  Total Items: 245
  Valid Items: 238
  Invalid Items: 7
  Errors: 7
  Warnings: 12

‚úÖ REQUIRED FIELDS CHECK
  ‚úì product_id: 245/245
  ‚úì name: 238/245
  ‚úì price: 245/245

üìà FIELD STATISTICS
  price:
    ‚Ä¢ Filled: 245/245 (100.0%)
    ‚Ä¢ Type: float
  rating:
    ‚Ä¢ Filled: 187/245 (76.3%)
    ‚Ä¢ Type: float

‚ùå ERRORS (7)
  1. Field 'name' missing in 7 items
  2. Invalid price format in item 42

‚ö†Ô∏è  WARNINGS (12)
  1. Price 0 in item 5
  2. Empty description in item 17

üí° RECOMMENDATIONS
  ‚Ä¢ Field 'description' has only 45.3% filled...
  ‚Ä¢ Consider updating selectors or adding fallback methods...

======================================================================
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

–ü–æ–ª—É—á–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ –ø–∞—Ä—Å–∏–Ω–≥–µ:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫
ls logs/stats/

# –ö—Ä–∞—Ç–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
cat logs/stats/alkoteka_20241203_153000.json

# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ jq
jq '.items_per_minute, .duration_seconds' logs/stats/*.json
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ unit —Ç–µ—Å—Ç–∞–º–∏:

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

| –ú–æ–¥—É–ª—å | –¢–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å |
|--------|-------|--------|
| test_items.py | 59 | ‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã |
| test_middlewares.py | 13 | ‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã |
| test_proxy_middleware.py | 11 | ‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã |
| test_spider.py | 75 | ‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã |
| test_pipelines.py | 29 | ‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã |
| **–ò–¢–û–ì–û** | **187** | **‚úÖ –í—Å–µ –ø—Ä–æ–π–¥–µ–Ω—ã** |

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
cd alkoteka_parser

# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –º–æ–¥—É–ª—å
pytest tests/test_spider.py -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=alkoteka_parser tests/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
pytest tests/test_spider.py::TestAlkotekaSpider::test_parse_product -v
```

### –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤

- **test_spider.py**: –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Ç–æ–≤–∞—Ä–æ–≤, –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **test_pipelines.py**: –í–∞–ª–∏–¥–∞—Ü–∏—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π, –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **test_items.py**: Helper —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **test_middlewares.py**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–º, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### üìã Scrapy Contract Tests

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã** –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–∞—Ä—Å–∏–Ω–≥ –º–µ—Ç–æ–¥–æ–≤ spider –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö.

#### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã

Spider —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤ docstrings:

```python
def start_requests(self):
    """
    Generate initial requests for all product categories.

    @contract
    @returns requests 1 100
    """
    # –ö–æ–¥ –º–µ—Ç–æ–¥–∞

def parse_category(self, response):
    """
    Parse a category page and extract product links.

    @contract
    @url https://alkoteka.com/catalog/category/vodka/
    @returns requests 1 100
    """
    # –ö–æ–¥ –º–µ—Ç–æ–¥–∞

def parse_product(self, response):
    """
    Parse a product page and extract all product details.

    @contract
    @url https://alkoteka.com/product/test-product/
    @returns items 0 1
    """
    # –ö–æ–¥ –º–µ—Ç–æ–¥–∞
```

#### –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

- **`@contract`** - –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞
- **`@url <URL>`** - URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è parse_* –º–µ—Ç–æ–¥–æ–≤)
- **`@returns requests <min> <max>`** - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Request'—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [min, max]
- **`@returns items <min> <max>`** - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Item'—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [min, max]
- **`@scrapes <field1> <field2>`** - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ Item —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç–∏ –ø–æ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ dependencies –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

–ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ Scrapy –∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

#### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–±–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤)

–ï—Å–ª–∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
cd alkoteka_parser

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ —á–µ—Ä–µ–∑ Shell
scrapy shell "https://alkoteka.com/catalog/category/vodka/"

# –í shell –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
>>> response.css('a.product-link::attr(href)').getall()  # –ö–∞—Ç–µ–≥–æ—Ä–∏—è
>>> response.css('h1::text').get()  # –¢–æ–≤–∞—Ä
>>> response.css('.price-current::text').get()  # –¶–µ–Ω–∞
```

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "ModuleNotFoundError: No module named 'scrapy'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
source venv/bin/activate  # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
pip install -r requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ settings.py:
```python
DOWNLOAD_TIMEOUT = 60  # –í–º–µ—Å—Ç–æ 30
AUTOTHROTTLE_MAX_DELAY = 20  # –í–º–µ—Å—Ç–æ 10
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–Ω—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ–º –æ–∂–∏–¥–∞–µ—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –°–µ–ª–µ–∫—Ç–æ—Ä—ã —É—Å—Ç–∞—Ä–µ–ª–∏ (—Å–∞–π—Ç –æ–±–Ω–æ–≤–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
2. –ü—Ä–æ–∫—Å–∏ IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–≥–∏–æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
python test_selectors.py https://url.com --product

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
cat logs/scrapy.log | grep ERROR

# –û—Ç–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ–∫—Å–∏
# –ò–∑–º–µ–Ω–∏—Ç–µ –≤ settings.py: PROXY_ENABLED = False
```

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–æ–≤–∞—Ä—ã –∏–º–µ—é—Ç –ø—É—Å—Ç—ã–µ –ø–æ–ª—è

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ debug —Å–∫—Ä–∏–ø—Ç:
```bash
python test_selectors.py https://product-url.com --product --verbose
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç.

### –ü—Ä–æ–±–ª–µ–º–∞: "ValidationPipeline dropped item"

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–≤–∞—Ä –Ω–µ –ø—Ä–æ—à—ë–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é (–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `grep "ValidationPipeline" logs/scrapy.log`
2. –û–±–Ω–æ–≤–∏—Ç–µ spider –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ–º–æ–≥–æ –ø–æ–ª—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å DEBUG —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
   ```bash
   scrapy crawl alkoteka -O result.json -L DEBUG 2>&1 | grep -i validation
   ```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–≤—Å–µ–≥–æ) | 4000+ |
| –°—Ç—Ä–æ–∫ spider –∫–æ–¥–∞ | 950+ |
| –°—Ç—Ä–æ–∫ middleware | 400+ |
| –°—Ç—Ä–æ–∫ pipeline | 255 |
| Unit —Ç–µ—Å—Ç–æ–≤ | 187 |
| –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ | ~95% |
| –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–µ–≥–∏–æ–Ω—ã | 83 |

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –≤–µ–±-—Å–∫—Ä–µ–π–ø–∏–Ω–≥—É –∏ –∞–Ω–∞–ª–∏–∑—É –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

---

## ‚úÖ –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- ‚úÖ **–≠—Ç–∞–ø 1-9**: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞, items, middleware, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ **–≠—Ç–∞–ø 10**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–æ–≤–∞—Ä–∞ (volume, color, JSON)
- ‚úÖ **–≠—Ç–∞–ø 11**: Pipeline –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–≠—Ç–∞–ø 12**: –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases –∏ –æ—à–∏–±–æ–∫ (errback, retry, redirect)
- ‚úÖ **–≠—Ç–∞–ø 13**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (validate_output.py, test_selectors.py)
- ‚úÖ **–≠—Ç–∞–ø 14**: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (README, requirements.txt, .gitignore, docstrings)
- ‚úÖ **–≠—Ç–∞–ø 15**: Scrapy Contract tests –∏ Scrapy Shell guide
- ‚úÖ **–≠—Ç–∞–ø 16**: Multi-format export (JSON, JSONL, CSV, XML)
- ‚úÖ **–≠—Ç–∞–ø 17**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ **–≠—Ç–∞–ø 18**: SQLite database export –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- üöÄ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é**

---

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è

```bash
cd /Users/expansion/PycharmProjects/Poduct-parser
source venv/bin/activate
cd alkoteka_parser
```

### 2. –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–∏–Ω–≥–∞

```bash
# –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –≤ JSON
scrapy crawl alkoteka -O result.json

# –ó–∞–ø—É—Å–∫ —Å –≤—ã–±–æ—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–∞
scrapy crawl alkoteka -O result.jsonl      # JSON Lines
scrapy crawl alkoteka -O result.csv        # CSV
scrapy crawl alkoteka -O result.xml        # XML

# –ó–∞–ø—É—Å–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ SQLite (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω pipeline)
scrapy crawl alkoteka
```

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

```bash
# –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
scrapy validate -f ../result.json

# –î–µ—Ç–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
scrapy validate -f ../result.json -v --stats
```

### 4. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# JSON
cat ../result.json | head

# JSONL (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä)
head -5 ../result.jsonl

# CSV (—Ç–∞–±–ª–∏—Ü–∞)
open ../result.csv

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
cat logs/stats/*.json | jq '.'
```

---

## üéØ –ù–æ–≤—ã–µ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (–≠—Ç–∞–ø—ã 15-18)

### üìú Scrapy Contract Tests
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞** –≤ docstrings –º–µ—Ç–æ–¥–æ–≤ spider
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- **@contract @url @returns** –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### üöÄ Multi-Format Export
- **JSON**: –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏
- **JSONL**: –ü–æ—Ç–æ–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä)
- **CSV**: –¢–∞–±–ª–∏—á–Ω–æ-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Excel/BI
- **XML**: –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏**: –≤—Ä–µ–º—è, –∫–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- **JSON + CSV –æ—Ç—á—ë—Ç—ã**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–ø–∫—É `logs/stats/`
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ (DEBUG, INFO, WARNING, ERROR)

### üóÑÔ∏è Database & Commands
- **SQLite Pipeline**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- **SQL –∑–∞–ø—Ä–æ—Å—ã**: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –∞–≥—Ä–µ–≥–∞—Ü–∏—è, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **–ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ validate**: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- **DatabaseManager**: Python API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **–≠–∫—Å–ø–æ—Ä—Ç CSV –∏–∑ –ë–î**: –≤—ã–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—ã

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
    ‚Üì
Scrapy Framework
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               Spider: AlkotekaSpider                ‚îÇ
‚îÇ  (–ø–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Ç–æ–≤–∞—Ä–æ–≤, –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Middleware: RegionMiddleware                ‚îÇ
‚îÇ         ProxyMiddleware                             ‚îÇ
‚îÇ  (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–æ–º –∏ –ø—Ä–æ–∫—Å–∏)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         ItemLoaders: ProductItemLoader              ‚îÇ
‚îÇ  (–ø–∞—Ä—Å–∏–Ω–≥ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Pipelines:                                         ‚îÇ
‚îÇ  ‚Ä¢ ValidationPipeline (–ø—Ä–æ–≤–µ—Ä–∫–∞)                   ‚îÇ
‚îÇ  ‚Ä¢ DefaultValuesPipeline (–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)   ‚îÇ
‚îÇ  ‚Ä¢ DataCleaningPipeline (–æ—á–∏—Å—Ç–∫–∞)                  ‚îÇ
‚îÇ  ‚Ä¢ SqlitePipeline (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î) [–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ]  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Extensions:                                        ‚îÇ
‚îÇ  ‚Ä¢ StatsCollector (—Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)                ‚îÇ
‚îÇ  ‚Ä¢ TelegramNotifier (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)                  ‚îÇ
‚îÇ  ‚Ä¢ ErrorTracker (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Export Formats:                             ‚îÇ
‚îÇ  ‚îú‚îÄ JSON (–ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)                        ‚îÇ
‚îÇ  ‚îú‚îÄ JSONL (–ø–æ—Ç–æ–∫–æ–≤—ã–π)                              ‚îÇ
‚îÇ  ‚îú‚îÄ CSV (—Ç–∞–±–ª–∏—Ü–∞)                                  ‚îÇ
‚îÇ  ‚îú‚îÄ XML (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)                        ‚îÇ
‚îÇ  ‚îî‚îÄ SQLite (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üìö –§–∞–π–ª–æ–≤–∞—è –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
obsahuje/
‚îú‚îÄ‚îÄ README.md                          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt                   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example                       # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .gitignore                         # Git ignore –ø—Ä–∞–≤–∏–ª–∞
‚îÇ
‚îú‚îÄ‚îÄ validate_output.py                 # –í–∞–ª–∏–¥–∞—Ü–∏—è JSON
‚îú‚îÄ‚îÄ test_selectors.py                  # –û—Ç–ª–∞–¥–∫–∞ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ alkoteka_parser/                   # –ì–ª–∞–≤–Ω–∞—è –ø–∞–ø–∫–∞ Scrapy
    ‚îú‚îÄ‚îÄ scrapy.cfg
    ‚îú‚îÄ‚îÄ README.md                      # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
    ‚îÇ
    ‚îú‚îÄ‚îÄ logs/
    ‚îÇ   ‚îú‚îÄ‚îÄ scrapy.log                 # –õ–æ–≥–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
    ‚îÇ   ‚îî‚îÄ‚îÄ stats/                     # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (JSON + CSV)
    ‚îÇ
    ‚îî‚îÄ‚îÄ alkoteka_parser/               # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç
        ‚îú‚îÄ‚îÄ __init__.py
        ‚îú‚îÄ‚îÄ settings.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Scrapy
        ‚îú‚îÄ‚îÄ items.py                   # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (56 –ø–æ–ª–µ–π)
        ‚îú‚îÄ‚îÄ item_loaders.py            # ItemLoader –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã
        ‚îú‚îÄ‚îÄ middlewares.py             # Region + Proxy middleware
        ‚îú‚îÄ‚îÄ pipelines.py               # –í–∞–ª–∏–¥–∞—Ü–∏—è + –æ—á–∏—Å—Ç–∫–∞
        ‚îú‚îÄ‚îÄ extensions.py              # Stats + Telegram extensions
        ‚îú‚îÄ‚îÄ exporters.py               # JSON Lines, CSV, XML exporters
        ‚îú‚îÄ‚îÄ database.py                # SQLite pipeline + manager
        ‚îú‚îÄ‚îÄ utils.py                   # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–æ–∫—Å–∏
        ‚îÇ
        ‚îú‚îÄ‚îÄ spiders/
        ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
        ‚îÇ   ‚îî‚îÄ‚îÄ alkoteka_spider.py    # –û—Å–Ω–æ–≤–Ω–æ–π spider (1060+ —Å—Ç—Ä–æ–∫)
        ‚îÇ
        ‚îî‚îÄ‚îÄ commands/
            ‚îú‚îÄ‚îÄ __init__.py
            ‚îî‚îÄ‚îÄ validate.py            # –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ validate

tests/
‚îú‚îÄ‚îÄ test_spider.py                     # 75 —Ç–µ—Å—Ç–æ–≤ spider
‚îú‚îÄ‚îÄ test_items.py                      # 59 —Ç–µ—Å—Ç–æ–≤ items
‚îú‚îÄ‚îÄ test_pipelines.py                  # 29 —Ç–µ—Å—Ç–æ–≤ pipelines
‚îú‚îÄ‚îÄ test_middlewares.py                # 13 —Ç–µ—Å—Ç–æ–≤ middlewares
‚îú‚îÄ‚îÄ test_exporters.py                  # 40+ —Ç–µ—Å—Ç–æ–≤ exporters
‚îî‚îÄ‚îÄ test_proxy_middleware.py            # 11 —Ç–µ—Å—Ç–æ–≤ proxy
```

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 0.1.0
